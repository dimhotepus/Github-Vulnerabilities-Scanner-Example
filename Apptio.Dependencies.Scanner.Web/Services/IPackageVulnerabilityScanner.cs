using System.Collections.Generic;
using System.Threading;
using System.Threading.Tasks;
using Apptio.Dependencies.Scanner.Web.Dtos;
using Apptio.Dependencies.Scanner.Web.Models;

namespace Apptio.Dependencies.Scanner.Web.Services
{
    // Register new scanner instances with known interface.
    public interface IPackageVulnerabilityScanner
    {
        IEnumerable<Ecosystem> SupportedEcosystems { get; }

        Task<(List<VulnerablePackageDto> VulnerablePackages, List<FailedScanPackageDto> FailedScanPackages)> Scan(
            IDependencyPackages dependencyPackages, CancellationToken cancellationToken);
    }
}